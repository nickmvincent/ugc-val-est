Answered posted on: 2013-04-23 20:05:58+00:00
<a<p>if this is a project of enormous scale (e.g. millions of files), you might want to look into something like ***<a href="http://en.wikipedia.org/wiki/Map_reduce" rel="nofollow">map reduce</a>.</p>

<p>if not (which I'm guessing), I would suggest as follows:</p>

<p>parse each file sequentially, adding (appending)the results to each of TWO files.  Finally, combine the two files and you're done.</p>

<p>LOCATIONS_FILE (FILE 1)</p>

<pre><code>Location 1
Location 2
(etc)
</code></pre>

<p>METADATA_FILE (FILE 2)</p>

<pre><code>location 1 params
location 2 params
(etc)
</code></pre>

<p>when all files are parsed, append the contents of FILE 2 to those of FILE 1.</p>

<p>FINAL FILE</p>

<pre><code>Location 1
Location 2
(etc)
location 1 params
location 2 params
(etc)
</code></pre>

<p>I don't use VB.NET.  But, pseudocode would be something like:</p>

<pre><code>fn parse_file(file,locations_filehandle, metadata_filehandle):
    file.extract_locations() -&gt; append(locations_filehandle)
    file.extract_metadata() -&gt; append(metadata_filehandle)

fn main():
   for file in files:
      parse_file(file,locations_filehandle,metadata_filehandle)

   finalfile=locations_filehandle.read() + metadata_filehandle.read()
   finalfile.writeToDisk()


main()
</code></pr
